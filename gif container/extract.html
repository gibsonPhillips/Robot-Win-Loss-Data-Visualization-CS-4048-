<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weapon Average</title>
  </head>
  <body>
    <h2>Select a Weapon</h2>
    <form id="weaponForm">
      <label for="weaponSelect">Choose a weapon:</label>
      <select id="weaponSelect" name="weapon">
        <!-- Options will be populated dynamically -->
      </select>
      <br /><br />
      <button type="submit">Submit</button>
    </form>

    <div id="averageResult"></div>

    <script>
      // Load the CSV file and populate the dropdown options
      fetch("C:\Users\Marlin\Desktop\data viz\final project\average.csv")
        .then((response) => response.text())
        .then((data) => {
          // Parse CSV data
          const rows = data.split("\n").slice(1); // Remove header row
          const weapons = rows.map((row) => row.split(",")[0]); // Extract weapon names

          // Populate dropdown options
          const weaponSelect = document.getElementById("weaponSelect");
          weapons.forEach((weapon) => {
            const option = document.createElement("option");
            option.value = weapon;
            option.textContent = weapon;
            weaponSelect.appendChild(option);
          });
        });

      // Handle form submission
      document
        .getElementById("weaponForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          var weapon = document.getElementById("weaponSelect").value;
          getWeaponAverage(weapon);
        });

      // Fetch the average for the selected weapon
      function getWeaponAverage(weapon) {
        fetch("C:\Users\Marlin\Desktop\data viz\final project\average.csv")
          .then((response) => response.text())
          .then((data) => {
            const rows = data.split("\n");
            for (let i = 1; i < rows.length; i++) {
              // Start from 1 to skip header row
              const columns = rows[i].split(",");
              if (columns[0] === weapon) {
                const average = parseFloat(columns[1]);
                document.getElementById("averageResult").innerText =
                  "Average: " + average;
                break;
              }
            }
          });
      }
    </script>
  </body>
</html>
